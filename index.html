<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sri Ganesh Engineering College — App</title>
  <style>
    :root{--bg:#8be8f5;--card:#0f1724;--muted:#9aa6b2;--text:#eef2ff;--accent:#22c55e;--ring:#38bdf8}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;min-height:100vh;background:linear-gradient(180deg,#071023 0%, #081427 60%),var(--bg);color:var(--text);}
    .center {display:flex;align-items:center;justify-content:center;height:100vh}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.04);padding:18px;border-radius:12px;box-shadow:0 10px 30px rgba(2,6,23,0.6)}/* Login */
.login-wrap{width:360px}
.logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,#06b6d4,#8b5cf6,#22c55e);display:inline-block;margin-right:12px;vertical-align:middle}
h1{margin:0;font-size:1.2rem}
label{display:block;margin-top:12px;color:var(--muted);font-size:0.9rem}
input{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.05);background:transparent;color:var(--text);outline:none}
.btn{margin-top:14px;padding:10px 12px;border-radius:10px;border:none;background:linear-gradient(90deg,#06b6d4,#22c55e);color:#04210f;font-weight:700;cursor:pointer}
.link{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:8px;color:var(--muted);cursor:pointer}

/* Main layout */
header{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;border-bottom:1px solid rgba(255,255,255,0.03);position:sticky;top:0;background:linear-gradient(180deg,rgba(2,6,23,0.6),transparent)}
.brand{display:flex;align-items:center;gap:12px}
nav{display:flex;gap:8px}
.tab{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:10px;cursor:pointer}
.tab.active{outline:2px solid var(--ring)}
.container{max-width:1100px;margin:20px auto;padding:0 16px}
.grid{display:grid;gap:14px}
.card.small{padding:12px}

table{width:100%;border-collapse:collapse}
thead th{position:sticky;top:0;background:rgba(255,255,255,0.02);padding:10px;text-align:left}
td{padding:8px;border-top:1px solid rgba(248, 207, 207, 0.03)}
.scroll{max-height:58vh;overflow:auto;border-radius:10px;border:1px solid rgba(255,255,255,0.03);padding:8px}
.pill{display:inline-flex;gap:8px;align-items:center}
.pill input{width:18px;height:18px}
.actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
.muted{color:var(--muted)}
footer{color:var(--muted);text-align:center;margin:30px 0}

/* Responsive */
@media (max-width:720px){.container{padding:0 12px}}

  </style>
</head>
<body>  <!-- LOGIN -->  <div id="loginPage" class="center">
    <div class="card login-wrap">
      <div style="display:flex;align-items:center">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1> Sri Ganesh college of Engineering technology</h1>
          <div class="muted">Sign in to continue</div>
        </div>
      </div>
      <form id="loginForm" onsubmit="return doLogin(event)" style="margin-top:14px">
        <label>Username</label>
        <input id="loginUser" autocomplete="username" value="" />
        <label>Password</label>
        <input id="loginPass" type="password" autocomplete="current-password" />
        <div style="display:flex;gap:8px;align-items:center;margin-top:12px">
          <button class="btn" type="submit">Login</button>
          <button type="button" class="link" onclick="fillCreds()">Fill demo creds</button>
        </div>
        <div id="loginMsg" class="muted" style="margin-top:8px;font-size:0.9rem"></div>
      </form>
    </div>
  </div>  <!-- APP -->  <div id="app" style="display:none">
    <header>
      <div class="brand container">
        <div style="display:flex;align-items:center;gap:12px">
          <div class="logo" style="width:46px;height:46px;border-radius:8px"></div>
          <div>
            <div style="font-weight:800"> Sri Ganesh college of Engineering technology</div>
            <div class="muted" style="font-size:0.9rem">Attendance & Student Management</div>
          </div>
        </div>
        <nav id="nav"></nav>
      </div>
      <div style="padding-right:18px">
        <button class="tab" onclick="logout()">Logout</button>
      </div>
    </header><main class="container">
  <!-- HOME -->
  <section id="home" class="active">
    <div class="grid">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <h2 style="margin:0">Welcome to AI/DS students</h2>
            <div class="muted">Manage attendance, students and class sir details</div>
          </div>
          <div style="text-align:right">
            <div class="muted">Records saved locally</div>
            <div id="savedCount">0</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ATTENDANCE -->
  <section id="attendance">
    <div class="card small">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <strong>Attendance — 30 Students</strong>
          <div class="muted">Take attendance for today and submit to WhatsApp</div>
        </div>
        <div>
          <span class="muted">Present: <span id="presentCount">0</span></span>
          &nbsp;&nbsp;|&nbsp;&nbsp;
          <span class="muted">Absent: <span id="absentCount">0</span></span>
        </div>
      </div>
    </div>

    <div class="scroll card" style="padding:6px">
      <table>
        <thead>
          <tr><th style="width:48px">#</th><th>Name</th><th style="width:150px">Group</th><th style="width:220px">Status</th></tr>
        </thead>
        <tbody id="attBody"></tbody>
      </table>
    </div>

    <div class="actions">
      <button class="tab" onclick="markAll(true)">Mark All Present</button>
      <button class="tab" onclick="markAll(false)">Mark All Absent</button>
      <button class="btn" onclick="submitAttendance()">Submit & Send WhatsApp</button>
    </div>
  </section>

  <!-- PERSONAL DETAILS -->
  <section id="personal">
    <div class="card">
      <strong>Personal Details</strong>
      <div class="muted">Add student's personal details. These will appear in Student Details.</div>
    </div>
    <form id="personalForm" class="card" onsubmit="savePersonal(event)">
      <label>Student Name</label>
      <input id="p_name" required />
      <label>Class</label>
      <input id="p_class" required />
      <label>Group</label>
      <select id="p_group"><option>AI/DS</option><option>CS</option><option>EC</option><option>EEE</option></select>
      <label>Phone</label>
      <input id="p_phone" pattern="[0-9]{10}" />
      <label>Address</label>
      <textarea id="p_address" rows="3" style="width:100%;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04)"></textarea>
      <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:8px">
        <button type="reset" class="tab">Clear</button>
        <button type="submit" class="btn">Save Personal Details</button>
      </div>
    </form>
  </section>

  <!-- STUDENT DETAILS -->
  <section id="students">
    <div class="card small" style="display:flex;justify-content:space-between;align-items:center">
      <div><strong>Student Details</strong><div class="muted">Saved students (name, class, group, phone, address)</div></div>
      <div><input id="search" placeholder="Search by name/class/group" oninput="renderStudents()" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--text)" /></div>
    </div>
    <div class="scroll card" style="padding:6px">
      <table>
        <thead><tr><th style="width:48px">#</th><th>Name</th><th style="width:180px">Class</th><th style="width:100px">Group</th><th style="width:130px">Phone</th><th>Address</th></tr></thead>
        <tbody id="studentsBody"></tbody>
      </table>
    </div>
    <div style="display:flex;justify-content:flex-end;margin-top:8px"><button class="tab" onclick="clearStudents()">Clear All Students</button></div>
  </section>

  <!-- CLASS SIR -->
  <section id="sir">
    <div class="card small"><strong>Class Sir Details</strong><div class="muted">Add in-charge faculty details</div></div>
    <form id="sirForm" class="card" onsubmit="saveSir(event)">
      <label>Class</label><input id="s_class" required />
      <label>Sir Name</label><input id="s_name" required />
      <label>Phone</label><input id="s_phone" pattern="[0-9]{10}" />
      <label>Notes</label><input id="s_notes" />
      <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:8px"><button type="reset" class="tab">Clear</button><button class="btn">Save Sir Details</button></div>
    </form>
    <div class="card" style="margin-top:8px">
      <div class="muted">Saved Class Sir Details</div>
      <div class="scroll" style="padding:6px;margin-top:8px">
        <table><thead><tr><th>#</th><th>Class</th><th>Sir</th><th>Phone</th><th>Notes</th></tr></thead><tbody id="sirBody"></tbody></table>
      </div>
    </div>
  </section>

</main>
<footer>© <span id="year"></span> Sri Ganesh college of Engineering technology</footer>

  </div>  <script>
    // ---- Config: hardcoded login creds ----
    const DEMO_USER = 'aids';
    const DEMO_PASS = '2025';

    // ---- Helpers ----
    const $ = (s)=>document.querySelector(s);
    const $$ = (s)=>Array.from(document.querySelectorAll(s));
    const store = { get:(k,d)=>{try{return JSON.parse(localStorage.getItem(k)) ?? d}catch(e){return d}}, set:(k,v)=>localStorage.setItem(k,JSON.stringify(v)), del:(k)=>localStorage.removeItem(k) };

    // ---- NAV tabs ----
    const TABS = ['home','attendance','personal','students','sir'];
    function renderNav(active='home'){
      const nav = $('#nav'); nav.innerHTML=''; TABS.forEach(t=>{
        const b = document.createElement('button'); b.className='tab'+(t===active?' active':''); b.textContent=t.charAt(0).toUpperCase()+t.slice(1).replace(/([A-Z])/g,' $1');
        b.onclick=()=>switchTab(t); nav.appendChild(b);
      });
    }
    function switchTab(id){ $$('main section').forEach(s=>s.id===id? s.classList.add('active'): s.classList.remove('active')); $$('#nav .tab').forEach((b,i)=>b.classList.toggle('active',TABS[i]===id)); if(id==='students') renderStudents(); if(id==='sir') renderSirs(); }

    // ---- Login ----
    function doLogin(e){ e?.preventDefault(); const u=$('#loginUser').value.trim(); const p=$('#loginPass').value; if(u===DEMO_USER && p===DEMO_PASS){ $('#loginPage').style.display='none'; $('#app').style.display='block'; initApp(); return false;} else { $('#loginMsg').textContent='Invalid username or password'; return false; } }
    function fillCreds(){ $('#loginUser').value=DEMO_USER; $('#loginPass').value=DEMO_PASS; $('#loginMsg').textContent='Demo creds filled — click Login'; }
    function logout(){ if(confirm('Logout?')){ location.reload(); } }

    // ---- Attendance ----
    const DEFAULT_30 = Array.from({length:30},(_,i)=>({name:`Student ${i+1}`,group:['AI/DS','EC','CS','EEE'][i%4],present:false}));
    function initAttendance(){ const data = store.get('attendance_current', DEFAULT_30); store.set('attendance_current', data); renderAttendance(); }
    function renderAttendance(){ const tbody = $('#attBody'); const data = store.get('attendance_current', DEFAULT_30); tbody.innerHTML=''; let p=0; data.forEach((s,i)=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${i+1}</td><td><input value="${escapeHtml(s.name)}" data-idx="${i}" data-key="name" oninput="updateAtt(this)" style="width:100%;padding:6px;border-radius:6px;background:transparent;border:1px solid rgba(255,255,255,0.03)"/></td><td><select data-idx="${i}" data-key="group" onchange="updateAtt(this)">${['A','B','C','D'].map(g=>`<option value="${g}" ${s.group===g?'selected':''}>${g}</option>`).join('')}</select></td><td><label class="pill"><input type=checkbox ${s.present?'checked':''} onchange="togglePresent(${i},this.checked)"/> Present</label></td>`; tbody.appendChild(tr); if(s.present) p++; }); $('#presentCount').textContent=p; $('#absentCount').textContent= (data.length - p); }
    function updateAtt(el){ const idx=+el.dataset.idx; const key=el.dataset.key; const data=store.get('attendance_current', DEFAULT_30); data[idx][key]=el.value; store.set('attendance_current', data); }
    function togglePresent(idx,val){ const data=store.get('attendance_current', DEFAULT_30); data[idx].present=val; store.set('attendance_current', data); renderAttendance(); }
    function markAll(val){ const data=store.get('attendance_current', DEFAULT_30).map(s=>({...s,present:val})); store.set('attendance_current',data); renderAttendance(); }
    function submitAttendance(){ const current = store.get('attendance_current', DEFAULT_30); const today = new Date().toISOString().slice(0,10); const records = store.get('attendance_records',[]); records.push({date:today,list:current}); store.set('attendance_records',records); $('#savedCount').textContent = records.length; // Build whatsapp message
      const presentList = current.filter(s=>s.present).map(s=>`${s.name} (${s.group})`).join('\n') || 'None';
      const absentList = current.filter(s=>!s.present).map(s=>`${s.name} (${s.group})`).join('\n') || 'None';
      const msg = `Attendance for ${today}\nCollege: Sri Ganesh Engineering College\nPresent:\n${presentList}\n\nAbsent:\n${absentList}`;
      // Open WhatsApp - this opens web.whatsapp or mobile app depending on device. User must confirm send in WhatsApp.
      const phone = prompt('Enter WhatsApp number (with country code, e.g., 91xxxxxxxxxx) to send to. Leave empty to open WhatsApp chat selector.');
      const encoded = encodeURIComponent(msg);
      if(phone){ window.open(`https://wa.me/${phone}?text=${encoded}`, '_blank'); } else { window.open(`https://api.whatsapp.com/send?text=${encoded}`, '_blank'); }
      alert('Attendance saved locally and WhatsApp window opened (you must press send in WhatsApp).');
      // after submit, go to Personal Details
      switchTab('personal');
    }

    // ---- Personal & Student Details ----
    function savePersonal(e){ e?.preventDefault(); const entry={name:$('#p_name').value.trim(),clazz:$('#p_class').value.trim(),group:$('#p_group').value,phone:$('#p_phone').value.trim(),address:$('#p_address').value.trim()}; const list=store.get('student_details',[]); list.push(entry); store.set('student_details',list); e.target.reset(); alert('Personal details saved'); renderStudents(); switchTab('students'); }
    function renderStudents(){ const tbody=$('#studentsBody'); const list=store.get('student_details',[]); const q=($('#search')?.value||'').toLowerCase(); const out=list.map((s,i)=>({i:i+1,...s})).filter(s=>!q||s.name.toLowerCase().includes(q)||s.clazz.toLowerCase().includes(q)||String(s.group).toLowerCase().includes(q)); tbody.innerHTML= out.map(s=>`<tr><td>${s.i}</td><td>${escapeHtml(s.name)}</td><td>${escapeHtml(s.clazz)}</td><td>${escapeHtml(s.group)}</td><td>${escapeHtml(s.phone)}</td><td>${escapeHtml(s.address)}</td></tr>`).join(''); }
    function clearStudents(){ if(confirm('Delete ALL saved student details?')){ store.del('student_details'); renderStudents(); } }

    // ---- Class Sir ----
    function saveSir(e){ e?.preventDefault(); const entry={clazz:$('#s_class').value.trim(),name:$('#s_name').value.trim(),phone:$('#s_phone').value.trim(),notes:$('#s_notes').value.trim()}; const list=store.get('sir_details',[]); list.push(entry); store.set('sir_details',list); e.target.reset(); renderSirs(); alert('Class Sir saved'); }
    function renderSirs(){ const tbody=$('#sirBody'); const list=store.get('sir_details',[]); tbody.innerHTML=list.map((s,i)=>`<tr><td>${i+1}</td><td>${escapeHtml(s.clazz)}</td><td>${escapeHtml(s.name)}</td><td>${escapeHtml(s.phone)}</td><td>${escapeHtml(s.notes)}</td></tr>`).join(''); }
    function clearSirs(){ if(confirm('Delete ALL Class Sir details?')){ store.del('sir_details'); renderSirs(); } }

    // ---- Utilities & boot ----
    function escapeHtml(t){ return (t+'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
    function initApp(){ renderNav('home'); // ensure sections exist
      $$('main section').forEach(s=>s.classList.toggle('active', s.id==='home'));
      initAttendance(); renderStudents(); renderSirs(); $('#year').textContent=new Date().getFullYear(); const recs=store.get('attendance_records',[]); $('#savedCount').textContent=recs.length; // deep link support
      const h = location.hash.replace('#',''); if(TABS.includes(h)) switchTab(h);
    }

    // allow updating attendance inputs to call updateAtt from inline handlers
    window.updateAtt = updateAtt; window.togglePresent = togglePresent; window.markAll = markAll; window.submitAttendance = submitAttendance; window.savePersonal = savePersonal; window.renderStudents = renderStudents; window.saveSir = saveSir; window.renderSirs = renderSirs; window.clearStudents = clearStudents; window.clearSirs = clearSirs; window.fillCreds = fillCreds; window.logout = logout; window.doLogin = doLogin;

    // If user already authenticated state (naive): if appDisplayed flag
    if(localStorage.getItem('app_authenticated')==='true'){ $('#loginPage').style.display='none'; $('#app').style.display='block'; initApp(); }

    // mark app authenticated on successful login to persist until reload
    const originalDoLogin = doLogin;
    doLogin = function(e){ const res = originalDoLogin(e); if($('#loginUser').value.trim()===DEMO_USER && $('#loginPass').value===DEMO_PASS){ localStorage.setItem('app_authenticated','true'); } return res; };

    // expose doLogin to inline form
    window.doLogin = doLogin;
  </script></body>
</html>